// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  role      Role     @default(ADMIN)
  createdAt DateTime @default(now())
}

enum Role {
  ADMIN
  USER
}

model Config {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String
  updatedAt DateTime @updatedAt
}

model Discount {
  id          String  @id @default(cuid())
  type        String  // 'CASH_8', 'CASH_10_VOLUME', 'CASH_SMALL', 'CASH_MEDIUM', 'CASH_LARGE'
  percent     Float
  minArea     Float?
  maxArea     Float?
  isActive    Boolean @default(true)
  description String
}

model PaymentMethod {
  id        String  @id @default(cuid())
  name      String  // 'Efectivo', 'Mercado Pago', 'Ual√°'
  isActive  Boolean @default(true)
  details   String? // JSON: { installments: 6, noInterest: true }
}

model Service {
  id            String          @id @default(cuid())
  name          String
  icon          String
  description   String
  pricePerUnit  Float
  laborCost     Float
  unit          String
  isActive      Boolean         @default(true)
  order         Int             @default(0)
  quotes        Quote[]
  galleryImages GalleryImage[]
}

model Quote {
  id          String   @id @default(cuid())
  userId      String?
  serviceId   String
  service     Service  @relation(fields: [serviceId], references: [id])
  area        Float
  options     String   // JSON
  total       Float
  discount    Float
  finalPrice  Float
  createdAt   DateTime @default(now())
}

model Comment {
  id         String   @id @default(cuid())
  name       String
  comment    String
  service    String
  rating     Int      @default(5)
  isApproved Boolean  @default(false)
  createdAt  DateTime @default(now())
}

model GalleryImage {
  id          String   @id @default(cuid())
  serviceId   String
  service     Service  @relation(fields: [serviceId], references: [id])
  beforeUrl   String
  afterUrl    String
  title       String?
  description String?
  order       Int      @default(0)
  createdAt   DateTime @default(now())
}
